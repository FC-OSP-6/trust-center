"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const w=require("ts-morph"),b=require("node:path"),y=t=>t.toLowerCase().split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(""),P=t=>t.replace(/-([_a-z])/g,(o,a)=>a.toUpperCase()),U=t=>t.replace(/\/([a-z])/g,(o,a)=>a.toUpperCase()),R=t=>{const o=U(t);return P(`on-${o}`)},F=({components:t,stencilPackageName:o,customElementsDir:a,defaultExport:$=!1,hydrateModule:m,excludeServerSideRenderingFor:g})=>{const p=new w.Project({useInMemoryFileSystem:!0}),r=g||[],s=m?"":`'use client';

`,c=`/**
 * This file was automatically generated by the Stencil React Output Target.
 * Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.${m?`
 * Do __not__ import components from this file as server side rendered components
 * may not hydrate due to missing Stencil runtime. Instead, import these components through the generated 'components.ts'
 * file that re-exports all components with the 'use client' directive.`:""}
 */

`,u=`/* eslint-disable */
`,l=m?"createComponent, createSSRComponent":"createComponent",n=p.createSourceFile("component.ts",`${s}${c}${u}
import React from 'react';
import { ${l} } from '@stencil/react-output-target/runtime';
import type { EventName, StencilReactComponent } from '@stencil/react-output-target/runtime';
  `);for(const f of t){const d=f.tagName,h=y(d),E=`${h}Element`,_=`${h}CustomEvent`;n.addImportDeclaration({moduleSpecifier:`${o}/${a}/${d}.js`,namedImports:[{name:h,alias:E},{name:"defineCustomElement",alias:`define${h}`}]});const I=(f.events||[]).filter(e=>e.internal===!1),C=[];for(const e of I)if(Object.keys(e.complexType.references).length>0){for(const x of Object.keys(e.complexType.references))e.complexType.references[x].location==="global"||n.addImportDeclaration({moduleSpecifier:o,namedImports:[{name:x,isTypeOnly:!0}]});n.addImportDeclaration({moduleSpecifier:o,namedImports:[{name:_,isTypeOnly:!0}]}),C.push({originalName:e.name,name:R(e.name),type:`EventName<${_}<${e.complexType.original}>>`})}else C.push({originalName:e.name,name:R(e.name),type:`EventName<CustomEvent<${e.complexType.original}>>`});const S=`${h}Events`;n.addTypeAlias({name:S,type:C.length>0?`{ ${C.map(e=>`${e.name}: ${e.type}`).join(`,
`)} }`:"NonNullable<unknown>"});const j=`/*@__PURE__*/ createComponent<${E}, ${S}>({
    tagName: '${d}',
    elementClass: ${E},
    // @ts-ignore - React type of Stencil Output Target may differ from the React version used in the Nuxt.js project, this can be ignored.
    react: React,
    events: {${C.map(e=>`${e.name}: '${e.originalName}'`).join(`,
`)}} as ${S},
    defineCustomElement: define${h}
  })`,O=`/*@__PURE__*/ createSSRComponent<${E}, ${S}>({
    tagName: '${d}',
    properties: {${f.properties.filter(e=>!!e.attribute).map(e=>`${e.name}: '${e.attribute}'`).join(`,
`)}},
    hydrateModule: import('${m}')
  })`,D=n.addVariableStatement({declarationKind:w.VariableDeclarationKind.Const,declarations:[{name:h,type:`StencilReactComponent<${E}, ${S}>`,initializer:m&&!r.includes(d)?`typeof window !== 'undefined'
              ? ${j}
              : ${O}`:j}]});$?n.addExportAssignment({isExportEquals:!1,expression:h}):D.setIsExported(!0)}return n.organizeImports(),n.formatText(),n.getFullText()},A=({components:t,esModules:o})=>{const p=new w.Project({useInMemoryFileSystem:!0}).createSourceFile("component.ts",`'use client';

`+`/**
 * This file was automatically generated by the Stencil React Output Target.
 * Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
 */

`+`/* eslint-disable */
`);if(o)for(const r of t){const s=r.tagName,i=y(s),c=y(r.tagName);p.addExportDeclaration({moduleSpecifier:`./${c}`,namedExports:o?[`default as ${i}`]:t.map(u=>y(u.tagName))})}else p.addExportDeclaration({moduleSpecifier:"./components.server",namedExports:t.map(r=>y(r.tagName))});return p.organizeImports(),p.formatText(),p.getFullText()},q=async({stencilPackageName:t,components:o,outDir:a,customElementsDir:$,esModules:m,excludeComponents:g,project:p,hydrateModule:r,excludeServerSideRenderingFor:s})=>{const i=[],c=o.filter(l=>!(l.internal===!0||g!=null&&g.includes(l.tagName)));if(c.length===0)return[];const u={};if(m===!0)for(const l of c){const n=y(l.tagName),f=b.join(a,`${n}.ts`),d=F({components:[l],stencilPackageName:t,customElementsDir:$,defaultExport:!0,hydrateModule:r,excludeServerSideRenderingFor:s});u[f]=d}else{const l=r?b.join(a,"components.server.ts"):b.join(a,"components.ts"),n=F({components:c,stencilPackageName:t,customElementsDir:$,defaultExport:!1,hydrateModule:r,excludeServerSideRenderingFor:s});u[l]=n}if(r){const l=b.join(a,"components.ts"),n=A({components:c,esModules:m});u[l]=n}return await Promise.all(Object.entries(u).map(async([l,n])=>{const f=p.createSourceFile(l,n,{overwrite:!0});await f.save(),i.push(f)})),i},T="react-output-target",k="dist/components",v="dist-custom-elements",N="dist-hydrate-script",L=({outDir:t,esModules:o,stencilPackageName:a,excludeComponents:$,customElementsDir:m,hydrateModule:g,excludeServerSideRenderingFor:p})=>{let r=k;return{type:"custom",name:T,validate(s){if(m)r=m;else{const i=(s.outputTargets||[]).find(c=>c.type===v);if(i==null)throw new Error(`The '${T}' requires '${v}' output target. Add { type: '${v}' }, to the outputTargets config.`);if(i.dir!==void 0&&(r=i.dir),i.externalRuntime!==!1)throw new Error(`The '${T}' requires the '${v}' output target to have 'externalRuntime: false' set in its configuration.`)}if(g&&(s.outputTargets||[]).find(c=>c.type===N)==null)throw new Error(`The '${T}' requires '${N}' output target when the 'hydrateModule' option is set. Add { type: '${N}' }, to the outputTargets config.`);if(!t)throw new Error("The 'outDir' option is required.");if(a===void 0){if(s.sys&&s.packageJsonFilePath){const{name:i}=JSON.parse(s.sys.readFileSync(s.packageJsonFilePath,"utf8"));a=i}if(!a)throw new Error(`Unable to find the package name in the package.json file: ${s.packageJsonFilePath}. Please provide the stencilPackageName manually to the ${T} output target.`)}},async generator(s,i,c){const u=c.createTimeSpan(`generate ${T} started`,!0),l=c.components,n=new w.Project,f=await q({outDir:t,components:l,stencilPackageName:a,customElementsDir:r,esModules:o===!0,excludeComponents:$,project:n,hydrateModule:g,excludeServerSideRenderingFor:p});await Promise.all(f.map(d=>i.fs.writeFile(d.getFilePath(),d.getFullText()))),u.finish(`generate ${T} finished`)},__internal_getCustomElementsDir(){return r}}};exports.reactOutputTarget=L;
